# üèó HTMX + DRF API –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–ª–∏ –ø—Ä–æ–µ–∫—Ç –Ω–∞ **–µ–¥–∏–Ω—É—é API-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** –≥–¥–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ —Ç–≤–æ–∏ DRF endpoints.

## üéØ **–ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**

```
‚îå‚îÄ Frontend (HTMX + JavaScript) ‚îÄ‚îê    ‚îå‚îÄ Backend (Django DRF) ‚îÄ‚îê
‚îÇ                                 ‚îÇ    ‚îÇ                        ‚îÇ
‚îÇ ‚Ä¢ JWT –≤ localStorage            ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ ‚Ä¢ JWT Authentication   ‚îÇ
‚îÇ ‚Ä¢ HTMX requests + Bearer token ‚îÇ    ‚îÇ ‚Ä¢ API ViewSets         ‚îÇ
‚îÇ ‚Ä¢ Alpine.js –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è      ‚îÇ    ‚îÇ ‚Ä¢ –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã        ‚îÇ
‚îÇ ‚Ä¢ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ HTML templates   ‚îÇ    ‚îÇ ‚Ä¢ Permissions          ‚îÇ
‚îÇ ‚Ä¢ JavaScript API helpers       ‚îÇ    ‚îÇ ‚Ä¢ –ï–¥–∏–Ω–æ–µ API –¥–ª—è –≤—Å–µ—Ö  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## ‚úÖ **–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å**

### **–ë—ã–ª–æ (–≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥):**
- –í–µ–± ‚Üí Session-based auth + Django views  
- API ‚Üí JWT auth + DRF ViewSets

### **–°—Ç–∞–ª–æ (–µ–¥–∏–Ω—ã–π –ø–æ–¥—Ö–æ–¥):**
- –í–µ–± ‚Üí JWT auth + DRF API + HTMX
- –ú–æ–±–∏–ª—å–Ω—ã–µ ‚Üí JWT auth + DRF API + –Ω–∞—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

## üîß **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã**

### **1. –ë–∞–∑–∞ (`templates/base/api_base.html`)**
- **JWT —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** –≤ localStorage
- **Alpine.js store** –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏  
- **HTMX –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ —Ç–æ–∫–µ–Ω–æ–≤
- **API helpers** (`window.api.*`) –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å DRF
- **–ì–ª–æ–±–∞–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã** (—Å–æ–æ–±—â–µ–Ω–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫)

### **2. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**
- **`/login/`** ‚Üí `api_login.html` ‚Üí `/api/auth/api/login/`
- **`/register/`** ‚Üí `api_register.html` ‚Üí `/api/auth/api/register/`
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç** –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ 401** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º logout

### **3. Dashboard**
- **`/dashboard/`** ‚Üí `api_dashboard.html` 
- **–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è** —á–µ—Ä–µ–∑ `/api/auth/api/profile/`
- **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è** —á–µ—Ä–µ–∑ `/api/auth/api/update_profile/`
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** (–∑–∞–≥–æ—Ç–æ–≤–∫–∞ –¥–ª—è –±—É–¥—É—â–∏—Ö API)

## üöÄ **–ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**

### **JWT Token Management**
```javascript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ —Ç–æ–∫–µ–Ω–æ–≤ –≤ HTMX
document.addEventListener('htmx:configRequest', function(evt) {
    const token = getAuthToken();
    if (token) {
        evt.detail.headers['Authorization'] = 'Bearer ' + token;
    }
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤
document.addEventListener('htmx:responseError', function(evt) {
    if (evt.detail.xhr.status === 401) {
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π logout –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç
        localStorage.removeItem('access_token');
        window.location.href = '/login/';
    }
});
```

### **API Helpers**
```javascript
// –£–¥–æ–±–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API
window.api.get('/api/cars/')
window.api.post('/api/cars/', carData)
window.api.put('/api/cars/1/', updateData)
window.api.delete('/api/cars/1/')
```

### **Reactive UI —Å Alpine.js**
```javascript
// –°–æ—Å—Ç–æ—è–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
function authStore() {
    return {
        isAuthenticated: false,
        user: null,
        async fetchUserProfile() { ... },
        logout() { ... }
    }
}
```

## üìã **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**

### ‚úÖ **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ**
- **–û–¥–Ω–∏ –∏ —Ç–µ –∂–µ API endpoints** –¥–ª—è –≤–µ–±–∞ –∏ –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- **–ï–¥–∏–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏** –≤ DRF —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞—Ö
- **–û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞** —á–µ—Ä–µ–∑ DRF permissions

### ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**
- **–õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** - API —É–∂–µ –≥–æ—Ç–æ–≤–æ
- **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–¥–µ–ª–µ–Ω –æ—Ç –±—ç–∫–µ–Ω–¥–∞
- **API-first –ø–æ–¥—Ö–æ–¥** - –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –º–µ–Ω—è—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥

### ‚úÖ **–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å**
- **SPA-like –æ–ø—ã—Ç** —Å HTMX –±–µ–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ React/Vue
- **JWT —Ç–æ–∫–µ–Ω—ã** - industry standard
- **RESTful API** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥

### ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**
- **–ú–µ–Ω—å—à–µ Django views** - —Ç–æ–ª—å–∫–æ API endpoints
- **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏** –º–µ–∂–¥—É –≤–µ–± –∏ –º–æ–±–∏–ª—å–Ω—ã–º–∏
- **–õ—É—á—à–µ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**

## üîÑ **–¢–µ–∫—É—â–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã**

### **HTML Views** (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ)
```
GET  /           ‚Üí redirect to dashboard
GET  /login/     ‚Üí api_login.html
GET  /register/  ‚Üí api_register.html  
GET  /dashboard/ ‚Üí api_dashboard.html
```

### **API Endpoints** (–æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞)
```
POST /api/auth/api/login/          ‚Üí JWT login
POST /api/auth/api/register/       ‚Üí JWT register
GET  /api/auth/api/profile/        ‚Üí get user profile
PATCH /api/auth/api/update_profile/ ‚Üí update user profile
POST /api/auth/token/refresh/      ‚Üí refresh JWT token
```

## üì± **–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

### **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É –≤ `api_register.html`
2. JavaScript –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST `/api/auth/api/register/`
3. –ü–æ–ª—É—á–∞–µ—Ç JWT —Ç–æ–∫–µ–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ localStorage
4. –†–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ dashboard

### **–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è**
1. `api_dashboard.html` –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. Alpine.js –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ localStorage  
3. –î–µ–ª–∞–µ—Ç GET `/api/auth/api/profile/` —Å Bearer —Ç–æ–∫–µ–Ω–æ–º
4. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
1. –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –∏—Å—Ç–µ–∫ - API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401
2. HTMX –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≤–∏—Ç –æ—à–∏–±–∫—É
3. JavaScript –æ—á–∏—â–∞–µ—Ç localStorage –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ login

## üöÄ **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏**

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª **—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ API**:

1. **–°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª–∏** –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π (Car, Note, Expense)
2. **DRF ViewSets** –¥–ª—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π  
3. **HTMX —à–∞–±–ª–æ–Ω—ã** –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
4. **JavaScript** –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

–ö–∞–∂–¥–∞—è –Ω–æ–≤–∞—è —Ñ–∏—á–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å **–æ–¥–∏–Ω–∞–∫–æ–≤–æ** –¥–ª—è –≤–µ–±–∞ –∏ –±—É–¥—É—â–∏—Ö –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π!

---

üéâ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞!** –ï–¥–∏–Ω—ã–π API-–ø–æ–¥—Ö–æ–¥ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å.
